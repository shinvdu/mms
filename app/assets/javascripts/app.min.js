"use strict";function element_lists(){var e=[];return $("#video-clip-merge").children().each(function(){var a=$(this),t=a.attr("data-start"),n=a.attr("data-end");e.push({start:t,end:n})}),e}var main=function(){var e=new URI(location.href),a=e.search(!0).panel,t={hidden:!1},n=0!==$("#video-display").length?videojs("video-display"):void 0,i=$("#clip-frame"),r=i.parent(),s={horizontal:1,itemNav:"basic",smart:1,activateOn:"click",mouseDragging:1,touchDragging:1,releaseSwing:1,startAt:1,speed:300,elasticBounds:1,easing:"easeOutExpo",prev:r.find(".clip-prev"),next:r.find(".clip-next")},o=function(){for(var e,a,t,r=n.getValueSlider().start,s=n.getValueSlider().end,o=Math.floor(s)-Math.floor(r),d=videojs.formatTime(r),v=videojs.formatTime(s),u=videojs.formatTime(o),m=n.currentTime(),f=$.map($("#clip-frame li"),function(e){return Number($(e).attr("data-start"))}),g=f.length-1;g>=0;g--){if(!(s<=f[g])){t=g+1;break}if(0===g){t=0;break}}n.currentTime(n.getValueSlider().start).on("seeked",function(){e=$('<canvas width="74" height="48"></canvas>')[0],e.getContext&&e.getContext("2d").drawImage(n.player().el().firstChild,0,0,74,48),$("#clip-frame li").removeClass("active"),a=$("<li/>",{"data-start":r,"data-end":s}).append($("<div/>",{"class":"clip-canvas-wraper"}).append($(e)).append($("<div/>").append($("<button/>",{"class":"add-clip"}).append($("<i/>",{"class":"fa fa-plus"})).on("click",l)).append($("<button/>",{"class":"remove-clip"}).append($("<i/>",{"class":"fa fa-minus"})).on("click",p)))).append($("<div/>",{"class":"clip-info"}).append($("<span/>",{text:d})).append("-").append($("<span/>",{text:v})).append($("<br>")).append($("<span/>",{text:u}))).on("click",c)[0],i.sly("add",a,t),i.sly("activate",a),n.currentTime(m).off("seeked"),n.setValueSlider(s,s+10)})},l=function(){var e=$(this).closest("li"),a=e.attr("data-start"),t=e.attr("data-end"),n=Math.floor(t)-Math.floor(a),i=videojs.formatTime(a),r=videojs.formatTime(t),s=videojs.formatTime(n),o=$('<canvas width="74" height="48"></canvas>')[0];o.getContext&&o.getContext("2d").drawImage(e.find("canvas")[0],0,0,74,48),$("#video-clip-merge .active").removeClass("active"),$("<div/>",{"class":"video-clip-pill active","data-start":a,"data-end":t}).append($("<div/>",{"class":"clip-canvas-wraper"}).append($(o)).append($("<div/>").append($("<button/>",{"class":"remove-clip"}).append($("<i/>",{"class":"fa fa-minus"})).on("click",d)))).append($("<div/>",{"class":"clip-info"}).append($("<span/>",{text:i})).append("-").append($("<span/>",{text:r})).append($("<br>")).append($("<span/>",{text:s}))).on("click",c).appendTo($("#video-clip-merge")),event.stopPropagation()},p=function(){{var e=$(this).closest("li"),a=e.attr("data-start");e.attr("data-end")}$("#video-clip-merge").children('[data-start="'+a+'"]').remove(),i.sly("remove",e),event.stopPropagation()},d=function(){var e=$(this).closest(".video-clip-pill");e.remove(),event.stopPropagation()},c=function(){var e=$(this),a=e.attr("data-start"),t=e.attr("data-end");n.setValueSlider(a,t),n.pause(),n.currentTime(a),$("#clip-frame li").removeClass("active"),$("#video-clip-merge .active").removeClass("active"),e.addClass("active"),event.stopPropagation()};i.sly(s),n&&n.rangeslider(t),""!==a&&void 0!==a&&($(".nav-panel > li").removeClass("current"),$(".nav-panel > li").find('a[href="?panel='+a+'"]').parent().addClass("current"),$(".tab-panel").removeClass("current"),$("#"+a).addClass("current")),$("#user-name").on("click",function(e){$("#user-menu").toggle(),e.preventDefault()}),$(document).on("click",function(e){$("#user-menu").is(":visible")&&0===$(e.target).parents(".user-name").length&&$("#user-menu").hide()}),$("#btn-add-clip").on("click",function(){o.call(this)}),$(".btn-show-panel").on("click",function(){var e=$(event.target).attr("data-panel");$(".tab-panel").hide(),$("#"+e).show()}),$(".cus-input-item .form-control").on("focus",function(){$(this).prev().addClass("input-tip-focus")}),$(".cus-input-item .form-control").on("blur",function(){$(this).prev().removeClass("input-tip-focus")})};$(document).ready(main);