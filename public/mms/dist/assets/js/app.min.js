"use strict";function element_lists(){var e=[];return $("#video-clip-merge").children().each(function(){var a=$(this),t=a.attr("data-start"),i=a.attr("data-end");e.push({start:t,end:i})}),e}var main=function(){var e=new URI(location.href),a=e.search(!0).panel,t={hidden:!1},i=0!==$("#video-display").length?videojs("video-display"):void 0,n=$("#clip-frame"),s=n.parent(),r={horizontal:1,itemNav:"basic",smart:1,activateOn:"click",mouseDragging:1,touchDragging:1,releaseSwing:1,startAt:1,speed:300,elasticBounds:1,easing:"easeOutExpo",prev:s.find(".clip-prev"),next:s.find(".clip-next")},d=function(){for(var e,a,t,s=i.getValueSlider().start,r=i.getValueSlider().end,d=Math.floor(r)-Math.floor(s),l=videojs.formatTime(s),v=videojs.formatTime(r),u=videojs.formatTime(d),m=i.currentTime(),f=$.map($("#clip-frame li"),function(e){return Number($(e).attr("data-start"))}),g=f.length-1;g>=0;g--){if(!(r<=f[g])){t=g+1;break}if(0===g){t=0;break}}i.currentTime(i.getValueSlider().start).on("seeked",function(){e=$('<canvas width="74" height="48"></canvas>')[0],e.getContext&&e.getContext("2d").drawImage(i.player().el().firstChild,0,0,74,48),$("#clip-frame li").removeClass("active"),a=$("<li/>",{"data-start":s,"data-end":r}).append($("<div/>",{"class":"clip-canvas-wraper"}).append($(e)).append($("<div/>").append($("<button/>",{"class":"add-clip"}).append($("<i/>",{"class":"fa fa-plus"})).on("click",o)).append($("<button/>",{"class":"remove-clip"}).append($("<i/>",{"class":"fa fa-minus"})).on("click",p)))).append($("<div/>",{"class":"clip-info"}).append($("<span/>",{text:l})).append("-").append($("<span/>",{text:v})).append($("<br>")).append($("<span/>",{text:u}))).on("click",c)[0],n.sly("add",a,t),n.sly("activate",a),i.currentTime(m).off("seeked"),i.setValueSlider(r,r+10)})},o=function(){var e=$(this).closest("li"),a=e.attr("data-start"),t=e.attr("data-end"),i=Math.floor(t)-Math.floor(a),n=videojs.formatTime(a),s=videojs.formatTime(t),r=videojs.formatTime(i),d=$('<canvas width="74" height="48"></canvas>')[0];d.getContext&&d.getContext("2d").drawImage(e.find("canvas")[0],0,0,74,48),$("#video-clip-merge .active").removeClass("active"),$("<div/>",{"class":"video-clip-pill active","data-start":a,"data-end":t}).append($("<div/>",{"class":"clip-canvas-wraper"}).append($(d)).append($("<div/>").append($("<button/>",{"class":"remove-clip"}).append($("<i/>",{"class":"fa fa-minus"})).on("click",l)))).append($("<div/>",{"class":"clip-info"}).append($("<span/>",{text:n})).append("-").append($("<span/>",{text:s})).append($("<br>")).append($("<span/>",{text:r}))).on("click",c).appendTo($("#video-clip-merge")),event.stopPropagation()},p=function(){{var e=$(this).closest("li"),a=e.attr("data-start");e.attr("data-end")}$("#video-clip-merge").children('[data-start="'+a+'"]').remove(),n.sly("remove",e),event.stopPropagation()},l=function(){var e=$(this).closest(".video-clip-pill");e.remove(),event.stopPropagation()},c=function(){var e=$(this),a=e.attr("data-start"),t=e.attr("data-end");i.setValueSlider(a,t),i.pause(),i.currentTime(a),$("#clip-frame li").removeClass("active"),$("#video-clip-merge .active").removeClass("active"),e.addClass("active"),event.stopPropagation()};n.sly(r),i&&i.rangeslider(t),""!==a&&void 0!==a&&($(".nav-panel > li").removeClass("current"),$(".nav-panel > li").find('a[href="?panel='+a+'"]').parent().addClass("current"),$(".tab-panel").removeClass("current"),$("#"+a).addClass("current")),$("#user-name").on("click",function(e){$("#user-menu").toggle(),e.preventDefault()}),$(document).on("click",function(e){$("#user-menu").is(":visible")&&0===$(e.target).parents(".user-name").length&&$("#user-menu").hide()}),$("#btn-add-clip").on("click",function(){d.call(this)}),$(".cus-input-item .form-control").on("focus",function(){$(this).prev().addClass("input-tip-focus")}),$(".cus-input-item .form-control").on("blur",function(){$(this).prev().removeClass("input-tip-focus")})};$(document).ready(main);